# 空气质量预测模型：特征工程详解

**文档目标**：详细说明空气质量预测模型的特征工程设计原理、方法论和特征分类，帮助理解每个特征的业务含义和建模价值。

---

## 目录

1. [特征工程概述](#1-特征工程概述)
2. [基于 EDA 的特征设计依据](#2-基于-eda-的特征设计依据)
3. [特征分类与详细说明](#3-特征分类与详细说明)
4. [城市特定特征](#4-城市特定特征)
5. [特征工程流水线](#5-特征工程流水线)
6. [特征效果验证](#6-特征效果验证)

---

## 1. 特征工程概述

### 1.1 特征工程的目标

空气质量预测的核心挑战在于捕捉污染物浓度的时空变化规律和影响因素。特征工程的根本目标是将原始的污染物浓度数据和气象数据转化为机器学习模型能够有效学习的输入特征，从而提升预测准确性和泛化能力。

特征工程在本项目中承担三个关键角色：首先是**信息浓缩**，将分散的原始数据聚合为具有预测价值的信息单元；其次是**模式捕捉**，通过时间序列特征和交互特征揭示污染物变化的内在规律；最后是**领域知识融合**，将气象学和环境科学的专业认知嵌入到特征设计中。

### 1.2 特征工程的设计原则

本项目的特征工程遵循数据驱动与领域知识相结合的设计原则。每一个特征的创建都有明确的业务逻辑支撑，而非单纯依赖统计检验。设计过程中重点考虑以下因素：特征与目标变量的相关性强度、特征的可解释性和业务含义、特征之间的独立性以避免多重共线性、特征对不同城市的适用性以及特征的时效性和可获取性。

### 1.3 特征总数与分类

经过完整的特征工程流水线处理后，模型可使用的特征总数超过 150 个，分为七大类别：时间特征类约 15 个、气象原始特征类约 10 个、滞后特征类约 40 个、滚动统计特征类约 30 个、交互特征类约 25 个、静态城市特征类约 15 个、目标变换特征类约 5 个。这种多维度的特征覆盖确保了模型能够从不同角度理解和预测空气质量变化。

---

## 2. 基于 EDA 的特征设计依据

### 2.1 关键相关性发现

通过探索性数据分析，我们识别出以下关键的相关性规律，这些发现直接指导了特征工程的设计方向。

**能见度与 PM2.5 的关系**是本项目发现的最强相关性指标。分析显示，能见度与 PM2.5 浓度之间存在约 -0.52 的强负相关关系，这意味着能见度每降低一个单位，PM2.5 浓度相应升高。这一发现促使我们创建了能见度的倒数特征和比值特征，以放大这种反向关联的预测能力。同时，根据能见度的数值范围，我们将城市能见度划分为五个等级：极差（0-1 公里）、差（1-4 公里）、中等（4-10 公里）、良好（10-50 公里）和优秀（50 公里以上），每个等级对应不同的污染潜势。

**风速与 PM2.5 的关系**呈现约 -0.41 的中等负相关。风速是影响污染物扩散的关键气象要素，高风速有助于污染物的水平和垂直输送，而低风速则导致污染物在近地面累积。基于这一发现，我们不仅保留了原始风速特征，还创建了风速等级特征，将风速按照蒲福风级分为无风、轻风、微风、柔风、清风、强风和大风等多个等级，每个等级对应不同的污染扩散能力。

**温度与臭氧的关系**显示出约 +0.35 的正相关，这一发现对理解臭氧的形成机制具有重要意义。臭氧是典型的光化学污染物，其生成需要充足的阳光和较高的气温。基于这一相关性，我们创建了温度与臭氧的交互特征，并针对夏季（6-8 月）设置了专门的臭氧季节指示器，以捕捉高温条件下臭氧浓度升高的规律。

### 2.2 滞后效应分析

时间序列分析揭示了污染物浓度存在明显的滞后效应，即前几天的污染物浓度对当天的浓度具有显著的预测作用。

**Lag-1 特征**是最重要的滞后变量，其与目标变量的相关性达到 0.56。这意味着如果昨天 PM2.5 浓度较高，今天很可能仍然维持较高的水平。Lag-1 特征反映了污染的短期持续性，这种持续性可能源于污染源的连续排放、气象条件的稳定维持，以及污染物在大气中的化学转化过程。

**Lag-7 特征**的相关性为 0.12，虽然相对较低，但捕捉了周周期模式。这种周周期模式可能与人类活动的周期性有关，例如工业生产的周运行模式、交通流量的周末变化等。Lag-7 特征帮助模型识别这种以周为单位的重复性模式。

**Lag特征重要性排序**（基于北京数据ACF/PACF分析）：

| Lag天数 | 相关系数 | 解释方差 | 优先级 | 推荐使用 |
|---------|---------|---------|--------|---------|
| 1天 | 0.56 | 31% | ⭐⭐⭐⭐⭐ | 必须使用 |
| 2天 | 0.42 | 18% | ⭐⭐⭐⭐ | 强烈推荐 |
| 3天 | 0.35 | 12% | ⭐⭐⭐ | 推荐 |
| 4天 | 0.30 | 9% | ⭐⭐ | 可选 |
| 5天 | 0.26 | 7% | ⭐⭐ | 可选 |
| 6天 | 0.23 | 5% | ⭐⭐ | 可选 |
| 7天 | 0.21 | 4% | ⭐⭐ | 周周期 |
| 14天 | 0.08 | 1% | ⭐ | 不推荐 |

**ACF/PACF分析结果**：
- **ACF缓慢衰减**：Lag-1相关性0.56，Lag-7仍0.21，说明存在强时序依赖性
- **PACF快速截断**：PACF在Lag-1后快速衰减，表明AR(1)模型可能足够
- **模型选择建议**：基于ACF/PACF特性，推荐优先使用lag_1作为核心时序特征，lag_2和lag_3作为辅助特征

**交叉污染物滞后**是本项目的一个创新特征设计。分析发现，不同污染物之间存在相互影响关系：PM2.5 的滞后值会影响臭氧浓度（因为 PM2.5 携带臭氧前体物），臭氧的滞后值也会影响 PM2.5（光化学二次生成），而 NO2 与 O3 之间存在复杂的昼夜循环关系。交叉污染物滞后特征将这种跨污染物的预测价值显式化。

### 2.2.1 详细相关性数值表

基于全数据集（6城市，7631条记录）的Spearman相关性分析：

| 气象变量 | PM2.5相关性 | PM2.5重要性 | O3相关性 | O3重要性 | 特征建议 |
|---------|------------|------------|---------|---------|---------|
| visibility_km | -0.52 | ⭐⭐⭐⭐⭐ | -0.08 | ⭐ | 核心特征 |
| wind_speed_kmh | -0.41 | ⭐⭐⭐⭐ | +0.15 | ⭐⭐ | 核心特征 |
| temp_avg_c | +0.22 | ⭐⭐⭐ | +0.35 | ⭐⭐⭐⭐ | 重要特征 |
| temp_max_c | +0.28 | ⭐⭐⭐ | +0.35 | ⭐⭐⭐⭐ | O3核心 |
| temp_min_c | +0.18 | ⭐⭐ | +0.32 | ⭐⭐⭐ | O3重要 |
| dewpoint_c | +0.15 | ⭐⭐ | +0.20 | ⭐⭐ | 辅助特征 |
| precip_mm | -0.12 | ⭐⭐ | -0.05 | ⭐ | 辅助特征 |
| station_pressure_hpa | -0.08 | ⭐ | -0.02 | ⭐ | 弱特征 |

### 2.2.2 城市敏感度差异

不同城市对气象因素的敏感度存在显著差异（R²值）：

| 城市 | 温度敏感度 | 能见度敏感度 | 风速敏感度 | 整体敏感度 | 特征策略 |
|------|-----------|-------------|-----------|-----------|---------|
| Beijing | 0.28 | 0.62 | 0.35 | 0.42 | 全部气象特征 |
| Houston | 0.22 | 0.45 | 0.30 | 0.32 | 重点能见度 |
| Los_Angeles | 0.12 | 0.48 | 0.28 | 0.29 | 重点能见度+O3 |
| Chicago | 0.15 | 0.35 | 0.25 | 0.25 | 均衡特征 |
| New_York | 0.10 | 0.32 | 0.22 | 0.21 | 均衡特征 |
| San_Francisco | 0.05 | 0.25 | 0.18 | 0.16 | 弱气象依赖 |

**敏感度特征工程建议**：
- 北京：所有气象特征均为核心特征，需重点加强温度-PM2.5的U型关系特征
- 洛杉矶：能见度和温度是核心特征，需加强温度-O3交互特征
- 旧金山：气象特征敏感度低，可更依赖时序特征（lag、rolling）
- 美国城市（NY, Chicago）：均衡使用各类特征

### 2.3 季节性模式

EDA 分析揭示了明显的季节性模式，不同季节的污染特征存在显著差异。

**北京冬季污染峰值**是最突出的季节性现象。数据显示，北京冬季（11 月至次年 2 月）PM2.5 浓度是夏季的 2.1 倍，这一差异主要源于冬季采暖带来的污染物排放增加。采暖季特征是针对这一现象设计的核心特征，它将 11 月至次年 2 月标记为高污染风险期。

**洛杉矶夏季臭氧峰值**呈现出与美国其他城市不同的季节模式。洛杉矶位于地中海气候区，夏季高温少雨，强太阳辐射和高温条件促进了臭氧的光化学生成。这一发现促使我们创建了城市-季节交互特征，以捕捉不同城市在不同季节的差异化污染模式。

**春季沙尘影响**在 3-4 月表现明显。这一时期的北京和类似城市容易受到沙尘暴影响，导致粗颗粒物浓度升高。春季峰值特征专门用于识别这一特殊污染事件。

### 2.4 城市差异分析

六城市对比分析显示了巨大的污染水平差异，这些差异构成了城市静态特征设计的基础。

**北京污染水平最高**，PM2.5 均值达到 37.9 微克每立方米，超过美国城市 3-6 倍。这种巨大差异主要源于中国北方的能源结构（煤炭占比高）、机动车保有量增长、城市规划导致的污染物累积效应，以及地形条件（西北方向的山脉阻碍污染物扩散）。

**旧金山污染水平最低**，PM2.5 均值仅为 6.5 微克每立方米。旧金山的优越空气质量得益于其独特的地理位置：沿海位置带来充沛的海风，强风速促进污染物扩散；温和的地中海气候减少了冬季采暖需求；相对稀疏的人口密度降低了人为排放。

**沿海城市普遍较好**的空气质量验证了海岸效应的积极作用。洛杉矶、纽约等沿海城市的扩散条件明显优于同纬度的内陆城市。沿海距离特征被纳入城市静态特征，用于捕捉这一地理规律。

### 2.5 分布特征与变换

**偏度问题**是目标变量的重要分布特征。原始 PM2.5 浓度的偏度高达 3.81，表明分布严重右偏，存在大量高值观测。这种偏态分布会影响某些机器学习模型的性能，特别是依赖正态假设的线性模型。

**变换方法对比**：

| 变换方法 | 偏度 | 峰度 | 适用场景 | 优点 | 缺点 |
|---------|------|------|---------|------|------|
| 无变换 | 3.81 | 21.3 | 树模型 | 保持原始尺度 | 异常值影响大 |
| Log(1+x) | 0.87 | 3.2 | 线性模型 | 简单高效 | 零值处理不理想 |
| Box-Cox | 0.52 | 2.8 | 线性模型 | 最优正态性 | 需正值，参数估计 |
| Sqrt | 1.25 | 4.5 | 一般场景 | 计算简单 | 变换效果较弱 |

**对数变换**有效解决了偏度问题。通过应用 log(1+x) 变换，偏度从 3.81 降至 0.87，分布接近正态。这一变换保留了原始数值的顺序关系，同时压缩了尾部值的尺度，使模型能够更好地处理不同范围的观测值。

**Box-Cox变换**是最优选择。基于EDA分析，Box-Cox变换将偏度从3.81降至0.52，峰度从21.3降至2.8，显著优于对数变换。Box-Cox变换通过自动寻找最优的λ参数，实现最佳的分布正态化效果。代码实现支持通过`method='boxcox'`参数启用该变换。

**Q-Q图验证**显示：
- 原始数据：严重偏离45°线，存在长尾
- Log变换：接近45°线，但在极端值处仍有偏差
- Box-Cox变换：几乎完美对齐45°线，正态性最佳

**建模建议**：
- 树模型（XGBoost/LightGBM/Random Forest）：可直接使用原始值
- 线性模型（Linear/Ridge/Lasso）：推荐Box-Cox变换，其次Log变换
- 神经网络：推荐Log变换，计算效率高
- 异常值敏感场景：使用Huber Loss + Box-Cox变换

---

## 3. 特征分类与详细说明

### 3.1 时间特征

时间特征用于捕捉污染物浓度的时间周期性规律，包括年度周期、月度周期、周周期等多尺度的时间模式。

**循环编码特征**采用正弦和余弦函数将时间信息编码为连续的周期信号。年度循环编码使用 day_sin 和 day_cos 两个特征，将一年中的第几天映射到圆周上，确保 12 月 31 日和 1 月 1 日在特征空间中相邻，这种编码方式避免了月份数值编码带来的边界问题。月度循环编码使用 month_sin 和 month_cos，将月份信息转化为周期信号，用于捕捉季节性模式。

**季节特征**将一年划分为四个季节：冬季（12-2 月）、春季（3-5 月）、夏季（6-8 月）和秋季（9-11 月）。季节特征与城市特征结合后，能够识别不同城市在不同季节的差异化表现，例如北京冬季高污染、洛杉矶夏季高臭氧等模式。

**周特征**包括工作日指示器、周一/周五特殊标记、周内位置（周初/周中/周末）等。这些特征用于捕捉与人类活动周期相关的污染变化规律，例如周一可能因周末累积而污染较高，周五可能因周末前排放增加而污染上升。

**特殊时期特征**针对采暖季（11-3 月）、臭氧生成季（6-8 月）和沙尘季（3-4 月）设置了专门的指示器。这些时期对应着特定类型的污染事件，模型可以通过这些特征学习到不同时期的污染规律。

### 3.2 气象交互特征

气象交互特征基于气象学原理，将多个气象要素组合以捕捉特定的污染形成条件。

**稳定大气特征**识别不利于污染物扩散的气象条件组合。当风速低于 5 公里每小时且气压高于 1010 百帕时，大气层结稳定，垂直混合受阻，污染物容易在近地面累积，形成逆温层。这种条件通常对应重污染天气，因此该特征具有较强的预测价值。

**潮湿低压特征**识别容易形成霾的气象条件。当露点温度高于 15 摄氏度且气压低于 1000 百帕时，大气湿度高且不稳定，容易形成雾霾天气。这一特征帮助模型识别这类特殊污染事件。

**湿沉降特征**识别降水清除污染的条件。当有降水且风速较低时，降水会通过冲刷作用清除大气中的颗粒物，但由于风速低，污染物不容易被水平输送走。这种条件下的污染变化模式较为特殊，需要单独的特征来表示。

### 3.3 污染物比率特征

污染物比率特征基于源解析原理，通过不同污染物的比值判断主要排放来源。

**PM2.5/PM10 比值**用于判断颗粒物的来源类型。当比值小于 0.5 时，表明粗颗粒物占比较高，可能以扬尘为主要来源；当比值大于 0.7 时，表明细颗粒物占比较高，可能以燃烧源（如机动车尾气、工业排放）为主要来源。这一特征帮助模型理解不同污染来源的相对贡献。

**NO2/SO2 比值**用于区分交通源和工业排放。NO2 主要来自机动车尾气，而 SO2 主要来自燃煤和工业过程。高比值表明交通排放占主导，低比值表明工业排放更为重要。

**O3/NO2 比值**反映光化学反应的强度。在强光化学条件下，NO2 快速光解产生 O3，导致 O3/NO2 比值升高。这一特征帮助模型识别光化学污染的程度。

### 3.4 交叉污染物滞后特征

交叉污染物滞后特征捕捉不同污染物之间的动态相互影响关系。

**PM2.5 到 O3 的滞后影响**反映 PM2.5 中携带的臭氧前体物（如挥发性有机物）在后续日期促进臭氧生成的过程。这种跨污染物的预测关系在光化学污染严重的地区尤为重要。

**O3 到 PM2.5 的滞后影响**反映臭氧参与的光化学反应生成二次有机颗粒物的过程。臭氧本身就是强氧化剂，能够将大气中的有机物氧化形成二次颗粒物，增加 PM2.5 浓度。

**NO2 与 O3 的昼夜循环**是一对相互转化的污染物。白天 NO2 光解产生 O3，夜间 O3 与 NO 反应重新生成 NO2。捕捉这种循环关系有助于理解臭氧的日变化规律。

### 3.5 天气类型特征

天气类型特征基于多个气象指标的综合判断，将天气状况分为不同的类型。

**降水类天气**包括雨天和小雨，降水通过湿清除作用降低大气颗粒物浓度。雨天特征帮助模型识别这类污染清除事件。

**雾霾类天气**包括霾和雾，两者都表现为低能见度，但形成机制不同。霾主要由颗粒物造成，能见度降低与 PM2.5 浓度直接相关；雾主要由水滴造成，能见度降低与相对湿度相关。天气类型特征帮助区分这两类看似相似但污染含义不同的天气状况。

**晴朗类天气**包括晴朗无风、晴朗大风和多云。晴朗大风对应良好的扩散条件，污染通常较低；晴朗无风则可能导致污染物累积。

### 3.6 滚动统计特征

滚动统计特征在时间窗口内计算目标变量的统计量，捕捉污染的近期趋势和波动性。

**滚动均值**计算过去 N 天的平均污染水平，是最重要的趋势特征。常用的窗口包括 7 天（周趋势）、14 天（双周趋势）和 30 天（月趋势）。滚动均值能够平滑短期波动，揭示污染的中期变化趋势。

**滚动标准差**计算过去 N 天污染水平的波动程度。高标准差表示近期污染变化剧烈，可能存在特殊的污染事件；低标准差表示污染水平相对稳定。

**滚动极值**包括滚动最大值和滚动最小值，分别记录过去 N 天的最高和最低污染水平。这些极值特征帮助模型识别极端污染事件。

**指数加权滚动**给予近期观测更高的权重，衰减权重随时间指数递减。这种加权方式更适合捕捉污染的快速变化特性，常用跨度为 3 天（短期）、7 天（中期）和 14 天（长期）。

### 3.7 污染持续性特征

污染持续性特征追踪连续高污染天数的累积效应。

**高污染连续天数**记录当前连续高污染（超过 35 微克每立方米 EPA 标准）的天数。持续的高污染天气表明存在持续的排放源或不利的气象条件，模型可以通过这一特征学习到累积效应。

**污染变化方向**记录当天相对于前一天污染水平的增减。持续上升趋势可能预示着重污染事件的开始。

**连续上升天数**记录污染水平连续上升的天数。长连续上升序列通常预示着重污染天气的到来。

### 3.8 事件间隔特征

事件间隔特征记录距离特定污染事件发生的天数。

**距离上次高污染的天数**反映污染累积的时间长度。距离上次高污染时间越长，污染累积的可能性越低。

**距离上次降水的天数**反映干燥期的持续长度。长时间无降水会导致颗粒物累积，增加污染风险。

### 3.9 AQI 类别特征

AQI 类别特征基于美国 EPA 的空气质量标准，将 PM2.5 浓度转换为健康等级。

**健康等级分类**将 AQI 分为六个等级：良好（0-50，绿色）、中等（51-100，黄色）、对敏感人群不健康（101-150，橙色）、不健康（151-200，红色）、非常不健康（201-300，紫色）和 危险（300 以上，褐红色）。

**等级数值编码**将类别转换为数值，便于模型处理。数值从 0 到 6 递增，反映健康风险程度的增加。

### 3.10 地理交互特征

地理交互特征将地理位置与气象条件相结合，捕捉地理位置对污染的调节作用。

**沿海距离与风速交互**反映海风对沿海城市的清洁作用。距离海岸越近，风速越大，对污染物的输送和稀释作用越强。

**海拔与气压交互**反映地形对大气压力的影响。高海拔地区气压低，大气稀薄，污染物浓度计算需要考虑这一因素。

**纬度与温度交互**反映不同纬度带气候条件的差异。高纬度地区温度变化更剧烈，季节性更明显。

---

## 4. 城市特定特征

### 4.1 北京特定特征

北京的污染特征具有明显的区域特殊性，需要专门设计特征来捕捉这些规律。

**北京-冬季交互特征**结合北京标识和冬季时间，识别北京冬季的高污染事件。这一特征的数值在北京的冬季时段为 1，其他时段为 0，模型可以通过这一特征学习到北京冬季的特殊污染模式。

**北京高污染交互特征**结合北京标识和高污染标识，识别北京特有极端污染事件。北京的高污染水平使得通用的 35 微克每立方米阈值可能偏低，因此需要针对北京设置更高的判断标准。

### 4.2 洛杉矶特定特征

洛杉矶的臭氧问题比 PM2.5 更为突出，需要专门设计臭氧相关特征。

**洛杉矶-夏季臭氧特征**结合洛杉矶标识和夏季时间，识别洛杉矶夏季臭氧高发期。这一特征帮助模型学习洛杉矶特有的夏季臭氧峰值模式。

### 4.3 沿海城市标识

沿海城市具有相似的污染扩散条件，需要统一的标识特征。

**沿海城市指示器**将距离海岸线 50 公里以内的城市标记为沿海城市。沿海城市通常具有较好的大气扩散条件，污染水平相对较低。

**内陆城市指示器**将距离海岸线 100 公里以上的城市标记为内陆城市。内陆城市污染物扩散条件较差，更容易出现污染累积。

---

## 5. 特征工程流水线

### 5.1 流水线的整体架构

特征工程流水线采用模块化设计，每个方法负责一类特征的生成，方法之间相互独立，便于调试和扩展。流水线的输入是原始合并数据（包含气象和污染物数据），输出是可用于建模的特征矩阵。

流水线的执行顺序经过精心设计，确保每个步骤依赖于前置步骤生成的特征。例如，交叉污染物滞后特征依赖于原始污染物列，因此排在滞后特征之后；滚动特征依赖于滞后特征，因此排在滞后特征之后。这种依赖关系确保了特征的正确生成。

### 5.2 预处理阶段

预处理阶段负责数据清洗和格式标准化，为后续特征工程奠定基础。

**日期格式转换**确保所有日期列转换为 pandas 的 datetime 类型，以便后续进行时间相关的操作。

**数值类型标准化**确保所有气象列和污染物列转换为数值类型，非数值内容标记为缺失值。

**异常值裁剪**根据领域知识对极端值进行限制：温度限制在 -30 到 45 摄氏度之间，PM2.5 限制在 0 到 500 微克每立方米之间。这些限制基于数据收集设备的能力范围和物理意义的合理区间。

**缺失值填充**使用线性插值和前向/后向填充方法处理气象数据的短时缺失，确保时间序列的连续性。

### 5.3 特征生成阶段

特征生成阶段按照特征类别依次生成各类特征。

**时间特征生成**首先进行，包括循环编码、季节特征、周特征和特殊时期特征。

**滞后特征生成**在时间特征之后进行，包括目标变量滞后、气象变量滞后和交叉污染物滞后。滞后操作按城市分组进行，确保城市间的时间序列不产生混淆。

**滚动特征生成**在滞后特征之后进行，利用滞后后的数据进行滚动计算，避免数据泄露。

**交互特征生成**结合多个原始特征或衍生特征，创建反映特定气象条件的组合特征。

**静态特征生成**最后进行，将城市级别的元数据合并到特征矩阵中。

### 5.4 目标变换阶段

目标变换阶段对目标变量进行数学变换，改善其分布特性。

**对数变换**将 PM2.5 浓度转换为对数尺度，有效压缩高值区域，扩展低值区域的信息量，使分布更接近正态。

### 5.5 实验配置

流水线支持多种实验配置，用于评估不同特征组合的效果。

**基础特征集（base）**仅包含气象原始特征和目标变量，用于建立性能基准。

**时间特征集（temporal）**在基础特征集上添加时间特征，用于评估时间模式的预测价值。

**滞后特征集（lags）**在时间特征集上添加滞后特征，用于评估时间序列依赖性的预测价值。

**交互特征集（interactions）**在滞后特征集上添加交互特征，用于评估气象组合的预测价值。

**完整特征集（full）**包含所有特征，用于评估整体特征工程的综合效果。

---

## 6. 特征效果验证

### 6.1 特征重要性分析

特征重要性分析用于评估各特征对模型预测的贡献程度。基于树的模型（如 XGBoost、LightGBM）可以通过特征分裂次数或增益来评估重要性；线性模型可以通过系数大小来评估重要性。

预期高重要性的特征包括：Lag-1 特征（时间序列强相关性）、能见度相关特征（强负相关）、滚动均值（趋势捕捉）、风速特征（扩散条件）等。

### 6.2 特征相关性检验

特征与目标变量的相关性是评估特征预测价值的初步指标。高相关性特征通常能够提供较强的预测信号，但也可能存在多重共线性问题。

相关性分析需要注意以下几点：使用 Spearman 相关系数捕捉非线性关系；排除滞后特征与同期目标变量的虚假相关；分析特征间的相关性，识别高共线性特征对。

### 6.3 城市泛化能力验证

城市泛化能力验证用于评估特征在不同城市的适用性。由于不同城市的污染特征存在显著差异，在单一城市表现良好的特征不一定适用于其他城市。

验证方法包括：在每个城市单独训练和测试，比较特征重要性排名的一致性；使用多城市混合数据训练，评估跨城市预测的准确性；针对每个城市计算特征贡献度，识别城市特异性特征。

### 6.4 时间外推验证

时间外推验证用于评估特征在未来时段的有效性。由于污染模式可能随时间变化（例如政策调整、技术进步），验证特征的时效性十分重要。

验证方法包括：使用较早时段的数据训练，较晚时段的数据测试，评估特征的时间稳定性；监控特征与目标变量相关性的时间变化趋势；定期重新计算特征重要性，适应潜在的分布漂移。

---

## 附录：特征速查表

| 特征类别 | 主要特征 | 预期相关性 | 业务含义 |
|----------|----------|------------|----------|
| 时间循环 | day_sin, day_cos, month_sin | 中 | 年度/月度周期 |
| 季节标识 | is_winter, is_summer_ozone | 高 | 季节性污染模式 |
| 滞后特征 | pm25_lag_1, pm25_lag_7 | 高 | 时间序列依赖 |
| 滚动均值 | pm25_roll_mean_7 | 高 | 近期趋势 |
| 能见度 | visibility_inverse | 高 | 污染反向指标 |
| 风速 | wind_speed_kmh | 中 | 扩散能力 |
| 交叉滞后 | pm25_to_o3_lag1 | 中 | 污染物相互作用 |
| 天气类型 | is_rainy, is_hazy | 中 | 特殊天气影响 |
| 城市静态 | lat, lon, dist_to_coast | 低 | 地理背景 |
| AQI类别 | aqi_level | 高 | 健康风险等级 |
