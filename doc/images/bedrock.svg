<svg xmlns="http://www.w3.org/2000/svg" width="450" height="660" viewBox="0 0 450 660" style="background-color: white; font-family: 'Helvetica Neue', Arial, sans-serif;">
  
  <!-- 定义箭头 -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#555" />
    </marker>
  </defs>

  <!-- 外框 Subgraph -->
  <rect x="30" y="20" width="390" height="620" rx="10" fill="#fcfcfc" stroke="#e0e0e0" stroke-width="1" stroke-dasharray="5,5"/>
  <text x="225" y="45" text-anchor="middle" fill="#999" font-weight="bold" font-size="14">生成流程</text>

  <!-- 1. User Node -->
  <rect x="125" y="60" width="200" height="45" rx="5" fill="#ECF0F1" stroke="#BDC3C7" stroke-width="1.5"/>
  <text x="225" y="88" text-anchor="middle" fill="#2C3E50" font-weight="bold" font-size="13">用户请求预测</text>

  <!-- Arrow -->
  <line x1="225" y1="105" x2="225" y2="135" stroke="#555" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- 2. Predict Node -->
  <rect x="125" y="135" width="200" height="45" rx="5" fill="#ECF0F1" stroke="#BDC3C7" stroke-width="1.5"/>
  <text x="225" y="163" text-anchor="middle" fill="#2C3E50" font-size="13">获取 AQI 预测</text>

  <!-- Arrow -->
  <line x1="225" y1="180" x2="225" y2="210" stroke="#555" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- 3. Prompt Node (Blue) -->
  <rect x="125" y="210" width="200" height="55" rx="5" fill="#3498DB" stroke="#2980B9" stroke-width="2"/>
  <text x="225" y="233" text-anchor="middle" fill="white" font-weight="bold" font-size="13">组装 Prompt</text>
  <text x="225" y="253" text-anchor="middle" fill="white" font-size="11" opacity="0.9">城市 + 天气 + AQI + 健康</text>

  <!-- Arrow -->
  <line x1="225" y1="265" x2="225" y2="295" stroke="#555" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- 4. Bedrock Node (Purple) -->
  <rect x="125" y="295" width="200" height="55" rx="5" fill="#9B59B6" stroke="#8E44AD" stroke-width="2"/>
  <text x="225" y="318" text-anchor="middle" fill="white" font-weight="bold" font-size="13">Amazon Bedrock</text>
  <text x="225" y="338" text-anchor="middle" fill="white" font-size="11" opacity="0.9">SDXL 生成</text>

  <!-- Arrow -->
  <line x1="225" y1="350" x2="225" y2="380" stroke="#555" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- 5. Image Node -->
  <rect x="125" y="380" width="200" height="45" rx="5" fill="#ECF0F1" stroke="#BDC3C7" stroke-width="1.5"/>
  <text x="225" y="408" text-anchor="middle" fill="#2C3E50" font-size="13">生成图片</text>

  <!-- Arrow -->
  <line x1="225" y1="425" x2="225" y2="455" stroke="#555" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- 6. S3 Node -->
  <rect x="125" y="455" width="200" height="45" rx="5" fill="#FF9900" stroke="#D68910" stroke-width="1.5"/>
  <text x="225" y="483" text-anchor="middle" fill="white" font-weight="bold" font-size="13">存储到 S3</text>

  <!-- Arrow -->
  <line x1="225" y1="500" x2="225" y2="530" stroke="#555" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- 7. CloudFront Node -->
  <rect x="125" y="530" width="200" height="45" rx="5" fill="#FF9900" stroke="#D68910" stroke-width="1.5"/>
  <text x="225" y="558" text-anchor="middle" fill="white" font-weight="bold" font-size="13">CloudFront 分发</text>

  <!-- Loop Back Arrow (The complicated part) -->
  <!-- Path: From CF Right -> Up -> To User Right -->
  <path d="M 325 552 L 360 552 Q 380 552 380 532 L 380 102 Q 380 82 360 82 L 335 82" 
        fill="none" stroke="#7f8c8d" stroke-width="1.5" stroke-dasharray="5,5" marker-end="url(#arrow)"/>

</svg>